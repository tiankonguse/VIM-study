# vim学习笔记之粘贴


## 基本操作


```text
p 粘贴
配置后，可以使用鼠标中键快捷粘贴
```


## 粘贴格式换乱

当我们的vim配置了自动缩进和自动补全括号和引号时,就会发现粘贴的时候,代码比较乱,而且后面多了很多括号和引号.  

这是因为vim不能识别我们发给他的代码,他当做输入流传给编辑器,遇到回车就改自动对齐继续对齐,然后我们的空白在对齐后追加在后面.结果就是没有对齐了.  

### 解决原因

对于这个问题该怎么解决呢?  

我们可以临时取消自动缩进和自动补全,粘贴完之后再启动这些配置就行了.  


```
#粘贴前,设置粘贴模式
:set paste

#这里粘贴

#粘贴后,取消粘贴模式
:set nopaste
```

### 原理解释

当我们设置了粘贴模式时,vim的环境都做了哪些事呢?  

- 屏蔽插入模式和命令行模式的映射
- 屏蔽缩写
- 'textwidth' 设为 0
- 'wrapmargin' 设为 0
- 'autoindent' 被复位
- 'smartindent' 被复位
- 'softtabstop' 设为 0
- 'revins' 被复位
- 'ruler' 被复位
- 'showmatch' 被复位
- 'formatoptions' 的使用方式就像它为空一样
- 'lisp' 失效
- 'indentexpr' 失效
- 'cindent' 失效


### 快捷键

使用上面的开关固然可以解决问题,但是总是敲哪几个命令嫌他麻烦,能不能配置成快捷键呢?  

答案肯定是可以的,关键在于我们怎么配置啦.  


最简单的是两个命令分别配置一个快捷键.  

```
:map <F10> :set paste<CR>
:map <F11> :set nopaste<CR>
```

使用两个快捷键虽然可以解决问题,但是如果可以使用一个快捷键就更好了.  

按一下打开开关,再按一下关闭开关.  

原来 vim 自带这个一个命令的.  

```
set pastetoggle=<F9>
```


 sj






## 参考资料

[解决vi/vim中粘贴会在行首多很多缩进和空格的问题][cnblogs-end-2531142]



##links
   * [目录](readme.md)



[cnblogs-end-2531142]: http://www.cnblogs.com/end/archive/2012/06/01/2531142.html
